define("mod_smartspe/savedraft",["jquery"],(function($){return{init:function(speid,sesskey){let timeout;const form=$(".mform"),lastSavedSpan=$("#draft-last-saved");console.log("Auto-save draft initialized for SPE ID:",speid),form.on("input change",(function(){clearTimeout(timeout),timeout=setTimeout((()=>{console.log("Auto-saving draft...");const data=form.serialize();$.post(M.cfg.wwwroot+"/mod/smartspe/student/savedraft.php",{speid:speid,sesskey:sesskey,data:data}).done((function(response){console.log("Draft saved");const json=JSON.parse(response),now=(new Date).toLocaleTimeString();"ok"===json.status?(console.log(json),lastSavedSpan.text("Last saved at "+now),lastSavedSpan.css("color","green")):(console.error("Save error:",json.message),lastSavedSpan.text("Save failed at "+now),lastSavedSpan.css("color","red"))})).fail((function(xhr){console.error("Save failed:",xhr.responseText)}))}),5e3)}))}}}));

//# sourceMappingURL=savedraft.min.js.map